# FireDetector
2019 경기대학교 통계자료분석 경진대회 (최우수상 수상) 2019.05

카메라를 이용한 자동 화재 인식 및 신고 시스템

사용라이브러리 : OpenCV, Tensorflow

## 아이디어 제안 배경


작은 화재가 큰 화재로 번지는 가장 큰 이유는 늦은 화재 진압이다. 화재 진압이 지연되는 데에는 다양한 이유가 존재하고, 그 중 초기 대응이 가장 중요하다. 초기 대응을 잘 하기 위해서는 화재를 신속하게 감지하고 신고를 해야 한다. 기존의 화재경보기는 주변 환경에 따라 오작동을 일으키는 경우가 많다. 무더위가 지속되는 여름철에 열을 감지해 빈번히 화재경보기가 작동되는 것을 볼 수 있다. 이러한 문제로 화재경보기를 꺼놓는 사용자들이 생겨나고 오인출동이 발생하고 있다. 이 문제를 해결하기 위해 CNN을 이용한 화재감지 및 신고 알고리즘을 개발했다. 

## CNN을 이용한 화재이미지 분류

![image](https://user-images.githubusercontent.com/52941937/80810338-92dafa80-8bfe-11ea-8e34-dd92b72b6725.png)

본 알고리즘 개발에서는 Google에서 수집한 748장의 불 이미지 중 598장을 학습 데이터(Train data), 150장을 실험 데이터(Test data)로 지정하였고, 871장의 불이 없는 이미지 중 697장을 학습 데이터(Train data), 174장을 실험 데이터(Test data)로 지정하여 학습을 진행 하였다. 1619개의 이미지를 분류하기 위해 컨볼루션(Convolution) 계층과 풀링(Pooling)계층이라는 2개의 계층이 서로 교차되어 이미지의 특징을 추출하고, 이를 3번 반복해 변화(Variation)에 영향을 받지 않는 특징을 추출하였다. 이후 2개의 완전 연결 계층(Fully connnected layer)에서 앞에서 추출된 특징을 사용해 이미지 분류를 수행한다.

학습 데이터(Train data)를 CNN의 전 방향으로 보내면서 cross-entropy cost 함수를 이용해 오차를 계산한다. 이를 다시 CNN의 역방향으로 보내면서 ‘Layer’들을 수정한다. 이런 과정을 반복하면서 CNN을 학습시킨다.

컨볼루션(Convolution) 계층과 풀링(Pooling) 계층에서 이미지의 특징을 추출 하는데 ‘Softmax’를 이용한다. 그러나 ‘Softmax’값은 0에서 1사이의 값을 갖기 때문에 ‘Layer’가 많아질수록 0으로 수렴해 이미지의 특징을 추출하는 데 문제가 생긴다. 이를 보안하기 위해 ‘Softmax’ 대신 0이하의 값은 0으로 하고, 0보다 큰 값은 그 값을 그대로 사용하는 ‘ReLu’를 사용 하여 CNN을 학습시켰다. 
또한 CNN학습 과정에서 발생하는 과적합(Overfitting)을 방지하기 위해 ‘Dropout’과 ‘Maxpooling’ 방법을 사용하였다. ‘Dropout’은 임의의 확률로 ‘Layer’들을 학습에서 제외시켜 과적합(Overfitting)을 방지하는 방법이고 ‘Maxpooling’은 풀링(Pooling)을 할 때 최대값을 대푯값으로 설정하는 방법이다. 결과적으로 정확도(Accuracy)가 1.0에 수렴하면서 학습이 잘 된 것을 볼 수 있다.

실험 데이터(Test data)를 이용해 CNN이 화재이미지를 잘 분류하는지 평가 하였을 때 정확도(Accuracy)는 0.94로 CNN이 새로운 이미지에 대해서도 분류를 잘 시행하는 것을 확인 하였다. 컴퓨터의 성능 문제로 많은 양의 데이터를 학습 시키지 못하고 픽셀 또한 28X28로 줄여서 학습을 시켰다. 고성능의 컴퓨터를 사용한다면 더 높은 정확도를 갖는 CNN을 만들어 화재이미지를 완벽하게 분류 할 수 있을 것으로 예상된다.
